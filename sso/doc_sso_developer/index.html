



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Developer Zone for netID, the european login standard of the European netID Foundation.">
      
      
        <link rel="canonical" href="https://1701.github.io/d/sso/doc_sso_developer/">
      
      
        <meta name="author" content="mste">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en, de">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>netID SSO - netID Developer Zone</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
     
  
    <style> 
    /* IBM Plex*/
    @font-face {
    font-family: 'IBM Plex Sans';
    font-style: normal;
    font-weight: 400;
    src: url('/fonts/ibm-plex-sans-v7-latin-regular.eot'); /* IE9 Compat Modes */
    src: local('IBM Plex Sans'), local('IBMPlexSans'),
        url('/fonts/ibm-plex-sans-v7-latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
        url('/fonts/ibm-plex-sans-v7-latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
        url('/fonts/ibm-plex-sans-v7-latin-regular.woff') format('woff'), /* Modern Browsers */
        url('/fonts/ibm-plex-sans-v7-latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
        url('/fonts/ibm-plex-sans-v7-latin-regular.svg#IBMPlexSans') format('svg'); /* Legacy iOS */
    }
    /* roboto-mono-regular - latin */
    @font-face {
    font-family: 'Roboto Mono';
    font-style: normal;
    font-weight: 400;
    src: url('/fonts/roboto-mono-v7-latin-regular.eot'); /* IE9 Compat Modes */
    src: local('Roboto Mono'), local('RobotoMono-Regular'),
        url('/fonts/roboto-mono-v7-latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
        url('/fonts/roboto-mono-v7-latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
        url('/fonts/roboto-mono-v7-latin-regular.woff') format('woff'), /* Modern Browsers */
        url('/fonts/roboto-mono-v7-latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
        url('/fonts/roboto-mono-v7-latin-regular.svg#RobotoMono') format('svg'); /* Legacy iOS */
    }

      body, input { 
        font-family: "IBM Plex Sans", "Helvetica Neue", 
          Helvetica, Arial, sans-serif; 
      } 
      pre, code, kbd { 
        font-family: "Roboto Mono", "Courier New", 
          Courier, monospace; 
      } 
    </style> 
  

    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="manifest" type="application/manifest+json" href="../../manifest.webmanifest" crossorigin="use-credentials">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="#76b82a" data-md-color-accent="#545454">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#single-sign-on-documentation" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://1701.github.io/d/" title="netID Developer Zone" aria-label="netID Developer Zone" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              netID Developer Zone
            </span>
            <span class="md-header-nav__topic">
              
                netID SSO
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." class="md-tabs__link">
          About netID
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../devportal/get_started/" class="md-tabs__link">
          netID Developer Portal
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" class="md-tabs__link md-tabs__link--active">
          netID Login Integration
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../cmp/cmp_1/" class="md-tabs__link">
          netID CMP Integration
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://1701.github.io/d/" title="netID Developer Zone" class="md-nav__button md-logo">
      
        <img alt="logo" src="../../images/logo.png" width="48" height="48">
      
    </a>
    netID Developer Zone
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      About netID
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        About netID
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      netID Developer Portal
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        netID Developer Portal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../devportal/get_started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../devportal/tutorial/services/" title="Services" class="md-nav__link">
      Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../devportal/tutorial/clients/" title="Clients" class="md-nav__link">
      Clients
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../devportal/tutorial/users/" title="User Management" class="md-nav__link">
      User Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../devportal/tutorial/testuser/" title="Test User" class="md-nav__link">
      Test User
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../devportal/reporting/" title="KPI Reports" class="md-nav__link">
      KPI Reports
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      netID Login Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        netID Login Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        netID SSO
      </label>
    
    <a href="./" title="netID SSO" class="md-nav__link md-nav__link--active">
      netID SSO
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#integration-guide" class="md-nav__link">
    Integration Guide
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-overview" class="md-nav__link">
    General Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#claims-und-scopes" class="md-nav__link">
    Claims und Scopes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authorize" class="md-nav__link">
    authorize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token" class="md-nav__link">
    token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo" class="md-nav__link">
    userinfo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timing-and-error-messages" class="md-nav__link">
    Timing and Error Messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    Implementation Details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#styling" class="md-nav__link">
    Styling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-information" class="md-nav__link">
    Security Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-of-sdks" class="md-nav__link">
    Use of SDKs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    General
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../styleguide/" title="netID Styleguide" class="md-nav__link">
      netID Styleguide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plugins/" title="netID Plugins" class="md-nav__link">
      netID Plugins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      netID CMP Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        netID CMP Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmp/cmp_1/" title="General information" class="md-nav__link">
      General information
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmp/cmp_2/" title="Browser-based API" class="md-nav__link">
      Browser-based API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmp/cmp_3/" title="Server-based API" class="md-nav__link">
      Server-based API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cmp/cmp_4/" title="Data export for partners" class="md-nav__link">
      Data export for partners
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#integration-guide" class="md-nav__link">
    Integration Guide
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-overview" class="md-nav__link">
    General Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#claims-und-scopes" class="md-nav__link">
    Claims und Scopes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authorize" class="md-nav__link">
    authorize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token" class="md-nav__link">
    token
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo" class="md-nav__link">
    userinfo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timing-and-error-messages" class="md-nav__link">
    Timing and Error Messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    Implementation Details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#styling" class="md-nav__link">
    Styling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-information" class="md-nav__link">
    Security Information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-of-sdks" class="md-nav__link">
    Use of SDKs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    General
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="single-sign-on-documentation">Single Sign-On Documentation<a class="headerlink" href="#single-sign-on-documentation" title="Permanent link">&para;</a></h1>
<p>This documentation describes the netID Single Sign-On to support the integration with interested relying parties. In order to aquire the necessary credentials to leverage this service please refer to the <a href="https://asr-enid.github.io/netid-docs/devPortal/services/">Developer Portal Documentation</a></p>
<h2 id="integration-guide">Integration Guide<a class="headerlink" href="#integration-guide" title="Permanent link">&para;</a></h2>
<h3 id="general-overview">General Overview<a class="headerlink" href="#general-overview" title="Permanent link">&para;</a></h3>
<p>The protocol standard applied is OpenID Connect as per the OpenID Connect Core 1.0 specification using the Authorization Code Flow.</p>
<p>Partners manage their data and clients in the netID Developer Portal. There, partners are able to manage their services, which may constitute groups of clients. These services receive the rights granted to partners by end users, which all clients in the group then have access to.</p>
<p>All the clients' communication takes place via EnID's central SSO broker. The SSO broker distributes requests among the participating account providers, end users always authenticate to the account provider responsible for them, which is also where they authorize the release of their data for partners' services.</p>
<p>Where necessary, clients request that data be released netID users; if the user agrees, the client receives an id_token and a userinfo object as a JSON structure.</p>
<p>What the id_token and userinfo objects contain in particular is the end user's subject identifier (sub), which constitutes an ID for both the end user with regard to the service he or she is using as well as the actual client's redirect URI (redirect_uri). This sub value allows the end user to be recognized on the client.</p>
<h3 id="claims-und-scopes">Claims und Scopes<a class="headerlink" href="#claims-und-scopes" title="Permanent link">&para;</a></h3>
<p>Every time netID is used to initiate an SSO process, details regarding which information is expected from the end user in the context of the request have to be provided.</p>
<p>For that purpose, the OpenID Connect/OAuth2 scope and claim mechanisms serve as definitions.</p>
<p>Every OpenID Connect request must always request the openid scope. Moreover, the master data required are to be expressed as essential claims.</p>
<p>Once released by the end user, master data need not be provided again unless revoked by the user. The user's approval is saved.</p>
<p>The following claims are supported by netID:</p>
<ul>
<li><strong>gender</strong> - the end user's gender</li>
<li><strong>given_name</strong> - the end user's first name (or names)</li>
<li><strong>family_name</strong> - the end user's last name</li>
<li><strong>birthdate</strong> - the end user's date of birth</li>
<li><strong>email</strong> - the end user's email address</li>
<li><strong>email_verified</strong> - the verification status of the end user's email address</li>
<li><strong>address</strong> - physical mailing address, containing informations on postal code (ZIP), city or town, steet address and country where the end user's address is located</li>
</ul>
<p>The availability of these claims may, however, vary depending on the end user's account provider; in such cases where not all requested claims are provided, the client must find a way around this.</p>
<p>Claims and scopes that are not requested as essential are ignored.</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<h3 id="authorize">authorize<a class="headerlink" href="#authorize" title="Permanent link">&para;</a></h3>
<p>authorize requests initiate SSO processes, the clients identify themselves with their client_id and redirect_uri and specify which claims and scopes are to be requested. Some optional parameters are also supported.</p>
<p>Here, the endpoint <a href="https://broker.netid.de/authorize">https://broker.netid.de/authorize</a> is used with the SSO broker.</p>
<p>Examples, given both easy readable as well as in valid URL encoding. The encoding needs to be used for the redirect_uri as well:</p>
<p><strong>Minimum Query - SSO without requesting any additional data</strong>
    <div class="codehilite"><pre><span></span><code>https://broker.netid.de/authorize?
    <span class="nv">response_type</span><span class="o">=</span>code<span class="p">&amp;</span>
    <span class="nv">client_id</span><span class="o">=[</span>clientID<span class="o">]</span><span class="p">&amp;</span>
    <span class="nv">redirect_uri</span><span class="o">=[</span>redirect_uri<span class="o">]</span><span class="p">&amp;</span>
    <span class="nv">scope</span><span class="o">=</span>openid
</code></pre></div></p>
<p><strong>Query for “profile” scope as essential claim</strong>
    <div class="codehilite"><pre><span></span><code>https://broker.netid.de/authorize?
    <span class="nv">response_type</span><span class="o">=</span>code<span class="p">&amp;</span>
    <span class="nv">client_id</span><span class="o">=[</span>clientID<span class="o">]</span><span class="p">&amp;</span>
    <span class="nv">redirect_uri</span><span class="o">=[</span>redirect_uri<span class="o">]</span><span class="p">&amp;</span>
    <span class="nv">scope</span><span class="o">=</span>openid<span class="p">&amp;</span>
    <span class="nv">claims</span><span class="o">={</span>
        <span class="s2">&quot;userinfo&quot;</span>:<span class="o">{</span>
            <span class="s2">&quot;birthdate&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;gender&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;given_name&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;family_name&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
</code></pre></div></p>
<p><strong>Query for claims that correspond to the “profile” scope and “address” as essential</strong>
    <div class="codehilite"><pre><span></span><code>https://broker.netid.de/authorize?
    <span class="nv">response_type</span><span class="o">=</span>code<span class="p">&amp;</span>
    <span class="nv">client_id</span><span class="o">=[</span>clientID<span class="o">]</span><span class="p">&amp;</span>
    <span class="nv">redirect_uri</span><span class="o">=[</span>redirect_uri<span class="o">]</span><span class="p">&amp;</span>
    <span class="nv">scope</span><span class="o">=</span>openid<span class="p">&amp;</span>
    <span class="nv">claims</span><span class="o">={</span>
        <span class="s2">&quot;userinfo&quot;</span>:<span class="o">{</span>
            <span class="s2">&quot;birthdate&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;address&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;gender&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;given_name&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>,
            <span class="s2">&quot;family_name&quot;</span>:<span class="o">{</span><span class="s2">&quot;essential&quot;</span>:true<span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
</code></pre></div></p>
<h3 id="token">token<a class="headerlink" href="#token" title="Permanent link">&para;</a></h3>
<p>Token requests are carried out after the callback to the client in order to exchange the code provided for an access token. It is absolutely necessary that the code used remains unmodified.</p>
<p>Here, the endpoint <a href="https://broker.netid.de/token">https://broker.netid.de/token</a> is used with the SSO broker. Client Credentials are required for basic authentication.</p>
<p>Example request per curl:</p>
<div class="codehilite"><pre><span></span><code>curl -v -u [user:pass] -X POST https://broker.netid.de/token -H &#39;content-type: application/x-www-form-urlencoded; charset=UTF-8&#39; -d &#39;code=[code]&amp;redirect_uri=[redirect_uri]&amp;grant_type=authorization_code&#39;
</code></pre></div>

<h3 id="userinfo">userinfo<a class="headerlink" href="#userinfo" title="Permanent link">&para;</a></h3>
<p>The access token is used to retrieve userinfo and id_token.</p>
<p>Here, the endpoint <a href="https://broker.netid.de/userinfo">https://broker.netid.de/userinfo</a> is used with the SSO broker.</p>
<h2 id="timing-and-error-messages">Timing and Error Messages<a class="headerlink" href="#timing-and-error-messages" title="Permanent link">&para;</a></h2>
<p>If the authorize request fails, the redirect_uri in the callback is given the reason why this occurred.</p>
<p>With token requests, it's particularly important to ensure that the code provided is identical bit-by-bit to the one received in the callback to the redirect_uri, and to be able to assume that basic authentication is being used properly here. Each code is only valid for 30 seconds!</p>
<p>Access tokens for the userinfo request are valid for 15 minutes and may also be used multiple times within this timeframe.</p>
<h2 id="implementation-details">Implementation Details<a class="headerlink" href="#implementation-details" title="Permanent link">&para;</a></h2>
<p>The following request parameters are supported for initiating the SSO process:</p>
<ul>
<li><em>prompt</em><ul>
<li>login for requiring reauthentication with the account provider</li>
<li>consent for requiring consent to be given again</li>
</ul>
</li>
<li><em>max_age</em><ul>
<li>in cases where time of authentication may not be too far in the past</li>
</ul>
</li>
<li><em>login_hint</em><ul>
<li>to provide and email address in order to prevent the broker's user interface from being visible to the user and thus directly redirect to the relevant account provider</li>
</ul>
</li>
<li><em>state</em><ul>
<li>The value of this parameter is passed through the entire flow transparently and included when calling back to the redirect_uri. It may be used to recognize how authorize request and asynchronous response are associated in the client.</li>
</ul>
</li>
</ul>
<p>The sequence of the calls is summarized as follows:</p>
<p><img alt="High Level Authentication Code Flow" src="../../diagrams/out/seq_sso_overview.svg" /></p>
<p>Detailed description of diagram:</p>
<ol>
<li>The end user initiates a process on the client's site that involves the use of netID.</li>
<li>At this point, the client generates a netID button for an authorize request and redirects the end user to the SSO broker.</li>
<li>The SSO broker validates the client's authorize request.</li>
<li>The SSO broker generates a new authorize request and redirects the user to the OpenID provider. For their part, the broker appears to the OpenID provider as a relying party client.</li>
<li>The OpenID provider validates the SSO broker's authorize request and displays the login screen to the end user; the user logs in with the account provider.</li>
<li>The OpenID provider shows an approval page to the end user on which all the data he or she is asked to allow transfer of is displayed.</li>
<li>The end user agrees to provide the requested data.</li>
<li>The OpenID provider generates an AuthN Response and redirects to the SSO broker.</li>
<li>The SSO broker receives the AuthN Response from the OpenID provider.</li>
<li>The SSO broker generates a new AuthN Response and redirects to the client's redirect_uri.</li>
<li>The client receives the SSO broker's AuthN Response.</li>
<li>The actual data query is initiated.</li>
<li>The client requests the access token with the SSO broker using the Auth Code (from the AuthN Response) and the Client Credentials.</li>
<li>The SSO broker requests the access token from the OP using the Auth Code (from the AuthN Response) and the Client Credentials taken from the client.</li>
<li>The OpenID provider issues an access token, giving it to the SSO broker.</li>
<li>The SSO broker uses the access token to generate a new access token, giving this one to the client.</li>
<li>The client uses the access token with the SSO broker to request the userinfo object.</li>
<li>The SSO broker uses the access token to request the userinfo object from the OpenID provider.</li>
<li>The OpenID provider grants the userinfo object to the SSO broker.</li>
<li>The SSO broker grants the userinfo object to the client.</li>
<li>The client has now received the userinfo object.</li>
</ol>
<h2 id="styling">Styling<a class="headerlink" href="#styling" title="Permanent link">&para;</a></h2>
<p>The depiction of the netID button is explained in the brand book.</p>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<p>It is largely up to the relying parties to decide where netID is to be incorporated in clients.</p>
<p>Typical cases involve the use of netID as a login or data enrichment mechanism.</p>
<p>As a login mechanism, for example, netID may be used like other SSO mechanisms (as well as alongside them) as an authentication alternative, or even used as the sole login method. Whether or not a local account is to be held in addition to the netID account is entirely up to the relying party. netID does not provide a classic session, but the SSO process is available via the authorize process at all times. An email address provided to the broker via a browser will be stored as a 1<sup>st</sup>-party cookie; the end user may decide whether to remain logged in with the account provider. The end user's approval for the transfer of master data will be sought only upon the first request for such data, unless the user revokes his or her approval; ideally, this allows SSO flows to be able to run even with interaction from the user.</p>
<p>If a relying party would like to also be able to handle authentication of end users independently of netID, it is advisable to ensure that mechanisms for merging or separating accounts are provided for. If local account representations with local credentials exist alongside netID, there should also be support processes for handling them; netID support processes only come into effect in connection with netID accounts themselves.</p>
<p>In terms of data enrichment, examples may include using netID during registration processes to make it easier for users to enter information, or as a source for addresses when customers are checking out with their shopping carts online. Whether the data provided is to be used only temporarily or whether it should persist is again left up to the relying parties to freely decide. Each time netID is triggered, the data obtained is up to date in relation to the information currently available to the account provider. With regard to local copies, it may be reasonable to repeatedly request updates and synchronize them. The relying party is to take the principles of data protection into account as they pertain to local data retention.</p>
<p>Ideally, data enrichment processes should be initiated in those places where the data is actually needed. This helps to optimize conversion rates while achieving a high degree of data minimization.</p>
<p>One thing to be aware of is the verification status of email addresses: if an email address has already been verified with netID, a new request from the relying party to verify the email address is, generally speaking, unnecessary and may cause confusion on the part of the end user. Those netID accounts associated with account providers that are, for their part, email providers, are verified from the outset. If such an email account is deleted, not only does the end user lose the ability to use netID, but all support processes based on that email address will come to nothing.</p>
<h2 id="security-information">Security Information<a class="headerlink" href="#security-information" title="Permanent link">&para;</a></h2>
<ul>
<li>All communication with netID must be secured by TLS. This also applies to all URLs entered in the developer portal.</li>
<li>netID exclusively supports the Authorization Code Flow, so that id_token is only transferred in TLS-secured back-end to back-end communication. Currently, the only token signature supported is none.</li>
</ul>
<h2 id="use-of-sdks">Use of SDKs<a class="headerlink" href="#use-of-sdks" title="Permanent link">&para;</a></h2>
<p>There are a large number of OpenID Connect client libraries available in many different language environments. Below, several examples will be given, along with tips for using them.</p>
<p>Many client libraries are listed at <a href="https://openid.net/developers/libraries/">https://openid.net/developers/libraries/</a>, and others are easy to find.</p>
<h3 id="general">General<a class="headerlink" href="#general" title="Permanent link">&para;</a></h3>
<p>Regardless of the choice of environment, it's possible to do the following preliminary experiments:</p>
<ol>
<li>In the developer portal for the partner, create a service, request approval for it, and then create a client for it</li>
<li>
<p>When choosing which URLs to use, it's possible to generate locally applicable test environments by making an entry in the hosts file of a developer workstation at the endpoints given for service and client and creating and using self-signed certificates.</p>
<blockquote>
<p><strong>Example</strong> "Entry in hosts" <br>
   127.0.0.1  <a href="http://www.democlient.de">www.democlient.de</a> <br><br>
<strong>Example</strong> "Creating a self-signed certificate" <br>
   openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout key.pem -out cert.pem</p>
</blockquote>
</li>
<li>
<p>Here, for the Common Name give the host name of the environment you want; so, in this case: <a href="http://www.democlient.de">www.democlient.de</a>.
Using the Client Credentials from the developer portal, the local host entry, and the certificate with the key, it's possible to run through the netID requests.</p>
</li>
<li>When testing with browsers, it's a good idea to use private windows; otherwise cookies left behind from previous run-throughs may cause confusion.
to top</li>
</ol>
<h3 id="examples_1">Examples<a class="headerlink" href="#examples_1" title="Permanent link">&para;</a></h3>
<p><strong>PHP</strong>
In PHP it's possible to use the package <a href="https://github.com/jumbojett/OpenID-Connect-PHP.However">https://github.com/jumbojett/OpenID-Connect-PHP.However</a>, some adjustments are necessary, since netID always uses none for the token signature algorithm in the Authorization Code Flow.</p>
<p>Installation according to instructions is no problem. The package derives the redirect_uri from its own URL; here, the position of the script in the path of the web server can either be used as redirect_uri when creating the client or configured accordingly in the web server using rewrite rules.</p>
<p>The following minimal diff makes OpenIDConnectClient.php netID-compatible:</p>
<div class="codehilite"><pre><span></span><code>844a845,848
&gt;         $signature = base64url_decode(array_pop($parts));
&gt;         if (false === $signature || &#39;&#39; === $signature) {
&gt;             throw new OpenIDConnectClientException(&#39;Error decoding signature from token&#39;);
&gt;         }
874,877d877
&lt; // netID has &#39;none&#39;
&lt;       case &#39;none&#39; :
&lt;           $verified=true;
&lt;           break;
</code></pre></div>

<p>A simple sample client may then look like this: client_example.php</p>
<p><strong>Javascript</strong>
One highly recommended JavaScript implementation (node.js) of an OpenID Connect relying party can be found here: <a href="https://www.npmjs.com/package/openid-client">https://www.npmjs.com/package/openid-client</a></p>
<p><strong>Java</strong>
Spring Security examples for Java:</p>
<ul>
<li>GitHub:mitreid-connect/simple-web-app</li>
<li>GitHub:eugenp/tutorials/tree/master/spring-security-openid</li>
</ul>
<p><strong>Rust</strong>
A good OpenID Connect relying party client for Rust can be found here: <a href="https://docs.rs/crate/oidc/0.2.0">https://docs.rs/crate/oidc/0.2.0</a>.</p>
<p><strong>Go</strong>
For go the package GitHub:coreos/go-oidc makes a netID login possible. The package may be installed here:</p>
<div class="codehilite"><pre><span></span><code>go get github.com/coreos/go-oidc
</code></pre></div>

<p>There is no explicit support for entering claims, essential or otherwise.</p>
<p>The simple example client netid.go first needs to be edited before Client Credentials, host name, and certificates may be entered, after which it can be run using:</p>
<div class="codehilite"><pre><span></span><code>go run netid.go
</code></pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      



<!-- Application footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">

        <!-- Link to previous page -->
        
          <a href="../../devportal/reporting/"
              title="KPI Reports"
              class="md-flex md-footer-nav__link md-footer-nav__link--prev"
              rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back
                    md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch
                  md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                KPI Reports
              </span>
            </div>
          </a>
        

        <!-- Link to next page -->
        
          <a href="../styleguide/"
              title="netID Styleguide"
              class="md-flex md-footer-nav__link md-footer-nav__link--next"
              rel="next">
            <div class="md-flex__cell md-flex__cell--stretch
                  md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                netID Styleguide
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward
                    md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid" align="center">

      <!-- Copyright and theme information -->
      <div class="md-footer-copyright">
        <a href="https://enid.eu" target="_blank">European netID Foundation</a> | <a href="https://example.com" target="_blank">Datenschutzhinweise</a> | <a href="https://enid.eu/partner" target="_blank">Partner werden</a> | <a href="https://developer.netid.de" target="_blank">netID Developer Portal</a>  
        
      </div>

      <!-- Social links -->
      
    </div>
  </div>
</footer>

    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
          
            
              
              
                <script src="../../assets/javascripts/lunr/lunr.de.js"></script>
              
            
          
          
            <script src="../../assets/javascripts/lunr/lunr.multi.js"></script>
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>